# <div align="center">ğŸ”¥ Unit 4 : Connect to the internet</div>

## <div align="center">Pathway 1 : Coroutines</div>

-----

### <div align="center">ëª©ì°¨</div>

- [Introduction to coroutines](#-Introduction-to-Coroutines)
  - [ë©€í‹°ìŠ¤ë ˆë”© ë° ë™ì‹œ ì‹¤í–‰](#ë©€í‹°ìŠ¤ë ˆë”©-ë°-ë™ì‹œ-ì‹¤í–‰)
  - [Challenges with thread](#Challenges-with-thread)
  - [Kotlinì˜ ì½”ë£¨í‹´](#Kotlinì˜-ì½”ë£¨í‹´)
  - [ì½”ë£¨í‹´ ì‚¬ìš©](#ì½”ë£¨í‹´-ì‚¬ìš©)

------

## <div align="center">ğŸ– Introduction to Coroutines</div>

### ë©€í‹°ìŠ¤ë ˆë”© ë° ë™ì‹œ ì‹¤í–‰

+ ê¸°ë³¸ ìŠ¤ë ˆë“œê°€ ì•„ë‹Œ ìŠ¤ë ˆë“œë¡œ ì‘ì—…í•˜ë©´ ì•±ì˜ ì‚¬ìš©ì **ì¸í„°í˜ì´ìŠ¤ ì‘ë‹µì„±ì„ ìœ ì§€**í•˜ë©´ì„œ ì•±ì´ **ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œì™€ ê°™ì€ ë³µì¡í•œ ì‘ì—…ì„ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ë™ì‹œ ì‹¤í–‰ ì½”ë“œ ë˜ëŠ” ê°„ë‹¨íˆ ë™ì‹œ ì‹¤í–‰ì´ë¼ê³  í•©ë‹ˆë‹¤. 

+ ë™ì‹œ ì‹¤í–‰(concurrency)ì„ í†µí•´ ì—¬ëŸ¬ ì½”ë“œ ë‹¨ìœ„ë¥¼ ìˆœì„œì— ë§ì§€ ì•Šê±°ë‚˜ ë³‘ë ¬ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆì–´ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ì˜ íš¨ìœ¨ì„±ì´ ë†’ì•„ì§‘ë‹ˆë‹¤. ìš´ì˜ì²´ì œëŠ” ì‹œìŠ¤í…œ, í”„ë¡œê·¸ë˜ë° ì–¸ì–´, ë™ì‹œ ì‹¤í–‰ ë‹¨ìœ„ì˜ íŠ¹ì„±ì„ ì‚¬ìš©í•˜ì—¬ ë©€í‹°íƒœìŠ¤í‚¹ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<img src = "https://user-images.githubusercontent.com/31370590/129470913-fa4ea670-08af-41f2-b5b3-1b5f4f5f9478.PNG">

+ ë™ì‹œ ì‹¤í–‰ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”? ì•±ì´ ì ì  ë³µì¡í•´ì§ì— ë”°ë¼ ì½”ë“œê°€ ì°¨ë‹¨ë˜ì§€ ì•ŠëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì¦‰, ë„¤íŠ¸ì›Œí¬ ìš”ì²­ê³¼ ê°™ì€ ì¥ê¸° ì‹¤í–‰ ì‘ì—…ì„ ì‹¤í–‰í•˜ë”ë¼ë„ ì•±ì—ì„œ ë‹¤ë¥¸ ì‘ì—…ì˜ ì‹¤í–‰ì´ ì¤‘ì§€ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. **ë™ì‹œ ì‹¤í–‰ì„ ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„í•˜ì§€ ì•Šìœ¼ë©´ ì•±ì´ ì‚¬ìš©ìì—ê²Œ ì‘ë‹µí•˜ì§€ ì•ŠëŠ” ê²ƒìœ¼ë¡œ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

<br>

+ Concurrent Programming ì˜ˆì‹œ

  ```kotlin
  fun main() {
      val thread = Thread {
          println("${Thread.currentThread()} has run.")
      }
      thread.start()
  }
  ```

  í•¨ìˆ˜ê°€ `start()` í•¨ìˆ˜ í˜¸ì¶œì— ë„ë‹¬í•˜ë©´ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.

  ```kotlin
  Thread[Thread-0,5,main] has run.
  ```

  `currentThread()`ëŠ” ìŠ¤ë ˆë“œì˜ ì´ë¦„, ìš°ì„ ìˆœìœ„, ìŠ¤ë ˆë“œ ê·¸ë£¹ì„ ë°˜í™˜í•˜ëŠ” ë¬¸ìì—´ í‘œí˜„ìœ¼ë¡œ ë³€í™˜ë˜ëŠ” `Thread` ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ìœ„ ì¶œë ¥ ë‚´ìš©ì´ ì•½ê°„ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

+ ì—¬ëŸ¬ ìŠ¤ë ˆë“œ ë§Œë“¤ê¸° ë° ì‹¤í–‰

  ```kotlin
  fun main() {
     val states = arrayOf("Starting", "Doing Task 1", "Doing Task 2", "Ending")
     repeat(3) {
         Thread {
             println("${Thread.currentThread()} has started")
             for (i in states) {
                 println("${Thread.currentThread()} - $i")
                 Thread.sleep(50)
             }
         }.start()
     }
  }
  ```

  ì´ì „ ì˜ˆì˜ ì •ë³´ ì¤„ì„ ì¶œë ¥í•˜ëŠ” ìŠ¤ë ˆë“œ 3ê°œë¥¼ ë§Œë“ ë‹¤.

  í”Œë ˆì´ ê·¸ë¼ìš´ë“œì˜ ì¶œë ¥

  ```kotlin
  Thread[Thread-2,5,main] has started Thread[Thread-2,5,main] - Starting Thread[Thread-0,5,main] - Doing Task 1 Thread[Thread-1,5,main] - Doing Task 1 Thread[Thread-2,5,main] - Doing Task 1 Thread[Thread-0,5,main] - Doing Task 2 Thread[Thread-1,5,main] - Doing Task 2 Thread[Thread-2,5,main] - Doing Task 2 Thread[Thread-0,5,main] - Ending Thread[Thread-2,5,main] - Ending Thread[Thread-1,5,main] - Ending Thread[Thread-0,5,main] has started
  Thread[Thread-0,5,main] - Starting
  Thread[Thread-1,5,main] has started
  Thread[Thread-1,5,main] - Starting
  ```

  AS(ì½˜ì†”)ì˜ ì¶œë ¥

  ```kotlin
  Thread[Thread-0,5,main] has started
  Thread[Thread-1,5,main] has started
  Thread[Thread-2,5,main] has started
  Thread[Thread-1,5,main] - Starting
  Thread[Thread-0,5,main] - Starting
  Thread[Thread-2,5,main] - Starting
  Thread[Thread-1,5,main] - Doing Task 1
  Thread[Thread-0,5,main] - Doing Task 1
  Thread[Thread-2,5,main] - Doing Task 1
  Thread[Thread-0,5,main] - Doing Task 2
  Thread[Thread-1,5,main] - Doing Task 2
  Thread[Thread-2,5,main] - Doing Task 2
  Thread[Thread-0,5,main] - Ending
  Thread[Thread-2,5,main] - Ending
  Thread[Thread-1,5,main] - Ending
  ```

  ì½”ë“œë¥¼ ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰í•©ë‹ˆë‹¤. ì¶œë ¥ì´ ë‹¤ì–‘í•˜ê²Œ í‘œì‹œë©ë‹ˆë‹¤. ì–´ë–¤ ë•ŒëŠ” ìŠ¤ë ˆë“œê°€ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ê³  ì–´ë–¤ ë•ŒëŠ” ì½˜í…ì¸ ê°€ ì—¬ê¸°ì €ê¸° í©ì–´ì ¸ ìˆìŠµë‹ˆë‹¤. ì´ ë¶ˆë³€ì„±ì€ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ë˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì¸í•´ ë°œìƒí•©ë‹ˆë‹¤. ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” ê° ìŠ¤ë ˆë“œì— ì¼ì • ì‹œê°„ì„ ì œê³µí•˜ê³  ìŠ¤ë ˆë“œëŠ” ê·¸ ì‹œê°„ ë‚´ì— ì™„ë£Œë˜ê±°ë‚˜ ë‹¤ë¥¸ ì‹œê°„ì„ ë°›ì„ ë•Œê¹Œì§€ ì •ì§€ë©ë‹ˆë‹¤.

<br>

<br>

### Challenges with thread

ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ë©´ ê°„ë‹¨í•˜ê²Œ ì—¬ëŸ¬ ì‘ì—…ê³¼ ë™ì‹œ ì‹¤í–‰ì„ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ ë¬¸ì œê°€ ì—†ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. `Thread`ë¥¼ ì½”ë“œì—ì„œ ì§ì ‘ ì‚¬ìš©í•˜ë©´ ì—¬ëŸ¬ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

#### ë§ì€ ë¦¬ì†ŒìŠ¤ê°€ í•„ìš”í•œ ìŠ¤ë ˆë“œ

+ ìŠ¤ë ˆë“œë¥¼ ë§Œë“¤ê³  ì „í™˜í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë°ëŠ” ë™ì‹œì— ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì›ì‹œ ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ì œí•œí•˜ëŠ” ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ì™€ ì‹œê°„ì´ ì‚¬ìš©ë©ë‹ˆë‹¤. ë§Œë“¤ê¸° ë¹„ìš©ì€ ë§¤ìš° ëŠ˜ì–´ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

+ ì‹¤í–‰ ì¤‘ì¸ ì•±ì—ëŠ” ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ìˆì§€ë§Œ ê° ì•±ì—ëŠ” ì „ìš© ìŠ¤ë ˆë“œê°€ í•˜ë‚˜ ìˆê³  íŠ¹íˆ ì•±ì˜ UIë¥¼ ë‹´ë‹¹í•©ë‹ˆë‹¤. ì´ ìŠ¤ë ˆë“œë¥¼ ê¸°ë³¸ ìŠ¤ë ˆë“œ ë˜ëŠ” UI ìŠ¤ë ˆë“œë¼ê³ ë„ í•©ë‹ˆë‹¤.
+ ì´ ìŠ¤ë ˆë“œëŠ” ì•±ì˜ UI ì‹¤í–‰ì„ ë‹´ë‹¹í•˜ë¯€ë¡œ **ê¸°ë³¸ ìŠ¤ë ˆë“œê°€ ì•±ì´ ì›í™œí•˜ê²Œ ì‹¤í–‰ë˜ë„ë¡ ì„±ëŠ¥ ê¸°ì¤€ì— ë§ëŠ” ê²ƒì´ ì¤‘ìš”**í•©ë‹ˆë‹¤. ì¥ê¸° ì‹¤í–‰ ì‘ì—…ì€ ì™„ë£Œë  ë•Œê¹Œì§€ ìŠ¤ë ˆë“œë¥¼ ì°¨ë‹¨í•˜ì—¬ ì•±ì´ ì‘ë‹µí•˜ì§€ ì•ŠëŠ” ì›ì¸ì´ ë©ë‹ˆë‹¤.
+ ìš´ì˜ì²´ì œëŠ” ì‚¬ìš©ìì—ê²Œ ì‘ë‹µì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ì‘ì—…ì„ ì‹œë„í•©ë‹ˆë‹¤. í˜„ì¬ íœ´ëŒ€ì „í™”ëŠ” UI ì—…ë°ì´íŠ¸ë¥¼ ì´ˆë‹¹ 60íšŒ~120íšŒ(ìµœì†Œ 60íšŒ) ì‹œë„í•©ë‹ˆë‹¤. í•œì •ëœ ì§§ì€ ì‹œê°„ì— UIë¥¼ ì¤€ë¹„í•˜ê³  ê·¸ë ¤ì•¼ í•©ë‹ˆë‹¤(ì´ˆë‹¹ 60í”„ë ˆì„, ê° í™”ë©´ ì—…ë°ì´íŠ¸ì— ê±¸ë¦¬ëŠ” ì‹œê°„ì€ 16ms ì´í•˜ì—¬ì•¼ í•¨).

<br>

#### Race conditionê³¼ ì˜ˆì¸¡í•  ìˆ˜ ì—†ëŠ” ë™ì‘

+ ì•ì—ì„œ ì„¤ëª…í–ˆë“¯ì´ **ìŠ¤ë ˆë“œ**ëŠ” **í”„ë¡œì„¸ì„œê°€ ì–´ë–»ê²Œ í•œ ë²ˆì— ì—¬ëŸ¬ ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ”ì§€ì— ê´€í•œ ì¶”ìƒí™”**ì…ë‹ˆë‹¤. í”„ë¡œì„¸ì„œê°€ ì—¬ëŸ¬ ìŠ¤ë ˆë“œì˜ ëª…ë ¹ì–´ ì§‘í•© ê°„ì— ì „í™˜í•  ë•Œ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ë˜ëŠ” ì •í™•í•œ ì‹œê°„ê³¼ ìŠ¤ë ˆë“œê°€ ì¼ì‹œì¤‘ì§€ë˜ëŠ” ì‹œì ì€ ê°œë°œìê°€ ì œì–´í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìŠ¤ë ˆë“œë¥¼ ì§ì ‘ ì‚¬ìš©í•  ë•Œ í•­ìƒ ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì¶œë ¥ì„ ê¸°ëŒ€í•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤.

+ ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒ ì½”ë“œëŠ” ê°„ë‹¨í•œ ë£¨í”„ë¥¼ ì‚¬ìš©í•˜ì—¬ 1ì—ì„œ 50ê¹Œì§€ ì„¸ì§€ë§Œ ì´ ê²½ìš°ì—ëŠ” ìˆ«ìê°€ ì¦ê°€í•  ë•Œë§ˆë‹¤ ìƒˆ ìŠ¤ë ˆë“œê°€ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. ì˜ˆìƒë˜ëŠ” ì¶œë ¥ ë‚´ìš©ì„ ìƒê°í•´ë³¸ í›„ ì½”ë“œë¥¼ ëª‡ ë²ˆ ì‹¤í–‰í•©ë‹ˆë‹¤.

  ```kotlin
  fun main() {
     var count = 0
     for (i in 1..50) {
         Thread {
             count += 1
             println("Thread: $i count: $count")
         }.start()
     }
  }uu
  ```

  ì¶œë ¥

  ```kotlin
  Thread: 50 count: 49 Thread: 43 count: 50 Thread: 1 count: 1
  Thread: 2 count: 2
  Thread: 3 count: 3
  Thread: 4 count: 4
  Thread: 5 count: 5
  Thread: 6 count: 6
  Thread: 7 count: 7
  Thread: 8 count: 8
  Thread: 9 count: 9
  Thread: 10 count: 10
  Thread: 11 count: 11
  Thread: 12 count: 12
  Thread: 13 count: 13
  Thread: 14 count: 14
  Thread: 15 count: 15
  Thread: 16 count: 16
  Thread: 17 count: 17
  Thread: 18 count: 18
  Thread: 19 count: 19
  Thread: 20 count: 20
  Thread: 21 count: 21
  Thread: 23 count: 22
  Thread: 22 count: 23
  Thread: 24 count: 24
  Thread: 25 count: 25
  Thread: 26 count: 26
  Thread: 27 count: 27
  Thread: 30 count: 28
  Thread: 28 count: 29
  Thread: 29 count: 41
  Thread: 40 count: 41
  Thread: 39 count: 41
  Thread: 41 count: 41
  Thread: 38 count: 41
  Thread: 37 count: 41
  Thread: 35 count: 41
  Thread: 33 count: 41
  Thread: 36 count: 41
  Thread: 34 count: 41
  Thread: 31 count: 41
  Thread: 32 count: 41
  Thread: 44 count: 42
  Thread: 46 count: 43
  Thread: 45 count: 44
  Thread: 47 count: 45
  Thread: 48 count: 46
  Thread: 42 count: 47
  Thread: 49 count: 48
  ```

  + ì½”ë“œê°€ ë‚˜íƒ€ë‚´ëŠ” ê²ƒê³¼ ë‹¬ë¦¬ **ë§ˆì§€ë§‰ ìŠ¤ë ˆë“œê°€ ì²« ë²ˆì§¸ë¡œ ì‹¤í–‰ë˜ê³  ë‹¤ë¥¸ ìŠ¤ë ˆë“œ ì¤‘ ì¼ë¶€ê°€ ìˆœì„œì— ë§ì§€ ì•Šê²Œ ì‹¤í–‰ëœ ê²ƒ ê°™ìŠµë‹ˆë‹¤.** ì¼ë¶€ ë°˜ë³µì˜ 'count'ë¥¼ ë³´ë©´ ì—¬ëŸ¬ ìŠ¤ë ˆë“œ í›„ì—ë„ ë³€ê²½ë˜ì§€ ì•Šê³  ìœ ì§€ë˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë” ì´ìƒí•œ ì ì€ ì¶œë ¥ì„ í†µí•´ ì‹¤í–‰í•  ë‘ ë²ˆì§¸ ìŠ¤ë ˆë“œì¼ ë¿ì„ì„ ì•Œ ìˆ˜ ìˆìŒì—ë„ ìŠ¤ë ˆë“œ 43ì—ì„œ ìˆ«ìê°€ 50ì— ë„ë‹¬í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì¶œë ¥ë§Œ ë†“ê³  ë³´ë©´ `count`ì˜ ìµœì¢…ê°’ì„ ì•Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

  + ì´ëŠ” ìŠ¤ë ˆë“œê°€ ì˜ˆì¸¡í•  ìˆ˜ ì—†ëŠ” ë™ì‘ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆëŠ” í•œ ê°€ì§€ ë°©ë²•ì¼ ë¿ì…ë‹ˆë‹¤. ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¡œ ì‘ì—…í•  ë•ŒëŠ” ê²½í•© ìƒíƒœë„ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ë©”ëª¨ë¦¬ì˜ ë™ì¼í•œ ê°’ì— ì•¡ì„¸ìŠ¤í•˜ë ¤ê³  í•  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ê²½í•© ìƒíƒœë¡œ ì¸í•´ ë¬´ì‘ìœ„ë¡œ ë³´ì´ëŠ” ë²„ê·¸ë¥¼ ì¬í˜„í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆê³  ì´ë¡œ ì¸í•´ ì˜ˆìƒì¹˜ ëª»í•œ ì•±ì˜ ë¹„ì •ìƒ ì¢…ë£Œë¥¼ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    ì„±ëŠ¥ ë¬¸ì œ, ê²½í•© ìƒíƒœ, ì¬í˜„í•˜ê¸° ì–´ë ¤ìš´ ë²„ê·¸ëŠ” ìŠ¤ë ˆë“œë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ë¼ê³  ê¶Œì¥í•˜ì§€ ì•ŠëŠ” ì´ìœ ì…ë‹ˆë‹¤. ëŒ€ì‹  ë™ì‹œ ì‹¤í–‰ ì½”ë“œ ì‘ì„±ì— ë„ì›€ì´ ë˜ëŠ” ì½”ë£¨í‹´ì´ë¼ëŠ” Kotlinì˜ ê¸°ëŠ¥ì— ê´€í•´ ì•Œì•„ë´…ë‹ˆë‹¤.

<br>

<br>

### Kotlinì˜ ì½”ë£¨í‹´

+ ë°±ê·¸ë¼ìš´ë“œ ì‘ì—…ì„ ìœ„í•œ ìŠ¤ë ˆë“œë¥¼ ì§ì ‘ ë§Œë“¤ê³  ì‚¬ìš©í•˜ëŠ” ê²ƒì€ Androidì—ì„œ ì´ë£¨ì–´ì§€ì§€ë§Œ Kotlinì€ **ë™ì‹œ ì‹¤í–‰ì„ ë” ìœ ì—°í•˜ê³  ì‰½ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì½”ë£¨í‹´ë„ ì œê³µ**í•©ë‹ˆë‹¤.

+ ì½”ë£¨í‹´ì€ ë©€í‹°íƒœìŠ¤í‚¹ì„ ì§€ì›í•˜ì§€ë§Œ ë‹¨ìˆœíˆ ìŠ¤ë ˆë“œë¡œ ì‘ì—…í•˜ëŠ” ê²ƒë³´ë‹¤ ë‹¤ë¥¸ ìˆ˜ì¤€ì˜ ì¶”ìƒí™”ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì½”ë£¨í‹´ì˜ ì£¼ìš” ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ëŠ” **ìƒíƒœë¥¼ ì €ì¥í•˜ì—¬ ì¤‘ë‹¨í–ˆë‹¤ê°€ ì¬ê°œí•  ìˆ˜ ìˆë‹¤**ëŠ” ê²ƒì…ë‹ˆë‹¤. ì½”ë£¨í‹´ì€ ì‹¤í–‰ë˜ê±°ë‚˜ ì‹¤í–‰ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

+ *ì—°ì†(continuations)*ìœ¼ë¡œ í‘œì‹œë˜ëŠ” ìƒíƒœë¥¼ í†µí•´ ì½”ë“œ ì¼ë¶€ê°€ ì œì–´ê¶Œì„ ë„˜ê²¨ì£¼ê±°ë‚˜ ì¬ê°œë˜ê¸° ì „ì— ë‹¤ë¥¸ ì½”ë£¨í‹´ì´ ì‘ì—…ì„ ì™„ë£Œí•  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•˜ëŠ” ì‹œê¸°ë¥¼ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ íë¦„ì„ í˜‘ë ¥ì ì¸ ë©€í‹°íƒœìŠ¤í‚¹(cooperative multitasking)ì´ë¼ê³  í•©ë‹ˆë‹¤. 

+ Kotlinì˜ ì½”ë£¨í‹´ êµ¬í˜„ì€ ë©€í‹°íƒœìŠ¤í‚¹ì„ ì§€ì›í•˜ëŠ” ì—¬ëŸ¬ ê¸°ëŠ¥ì„ ì¶”ê°€í•©ë‹ˆë‹¤. 
  ì—°ì† ì™¸ì—ë„ ì½”ë£¨í‹´ì„ ë§Œë“œëŠ” ê²ƒì—ëŠ” `CoroutineScope` ë‚´ì—ì„œ ìˆ˜ëª… ì£¼ê¸°ê°€ ìˆëŠ” ì·¨ì†Œ ê°€ëŠ¥í•œ ì‘ì—… ë‹¨ìœ„ì¸ `Job`ì˜ ì‘ì—…ì´ í¬í•¨ë©ë‹ˆë‹¤. 
  `CoroutineScope`ëŠ” í•˜ìœ„ ìš”ì†Œì™€ ê·¸ í•˜ìœ„ ìš”ì†Œì— ì·¨ì†Œ ë° ê¸°íƒ€ ê·œì¹™ì„ ë°˜ë³µì ìœ¼ë¡œ ì ìš©í•˜ëŠ” ì»¨í…ìŠ¤íŠ¸ì…ë‹ˆë‹¤. 
  `Dispatcher`ëŠ” ì½”ë£¨í‹´ì´ ì‹¤í–‰ì— ì‚¬ìš©í•  ì§€ì› ìŠ¤ë ˆë“œë¥¼ ê´€ë¦¬í•˜ë¯€ë¡œ ê°œë°œìê°€ ìƒˆ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•  ì‹œê¸°ì™€ ìœ„ì¹˜ë¥¼ íŒŒì•…í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.

  + Job : ì·¨ì†Œ ê°€ëŠ¥í•œ ì‘ì—… ë‹¨ìœ„(ì˜ˆ: `launch()` í•¨ìˆ˜ë¡œ ë§Œë“  ì‘ì—… ë‹¨ìœ„)ì…ë‹ˆë‹¤.
  + CoroutineScope : `launch()` ë° `async()`ì™€ ê°™ì€ ìƒˆ ì½”ë£¨í‹´ì„ ë§Œë“œëŠ” ë° ì‚¬ìš©ë˜ëŠ” í•¨ìˆ˜ëŠ” `CoroutineScope`ë¥¼ í™•ì¥í•©ë‹ˆë‹¤.
  + Dispatcher : ì½”ë£¨í‹´ì´ ì‚¬ìš©í•  ìŠ¤ë ˆë“œë¥¼ ê²°ì •í•©ë‹ˆë‹¤. `Main` ë””ìŠ¤íŒ¨ì²˜ëŠ” í•­ìƒ ê¸°ë³¸ ìŠ¤ë ˆë“œì—ì„œ ì½”ë£¨í‹´ì„ ì‹¤í–‰í•˜ì§€ë§Œ `Default`ë‚˜ `IO`, `Unconfined`ì™€ ê°™ì€ ë””ìŠ¤íŒ¨ì²˜ëŠ” ë‹¤ë¥¸ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

  ì´ ë‚´ìš©ì€ ë‚˜ì¤‘ì— ìì„¸íˆ ì•Œì•„ë³´ê² ì§€ë§Œ `Dispatchers`ëŠ” ì½”ë£¨í‹´ì´ ì¢‹ì€ ì„±ëŠ¥ì„ ë°œíœ˜í•  ìˆ˜ ìˆëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ìƒˆ ìŠ¤ë ˆë“œë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ë° ë“œëŠ” ì„±ëŠ¥ ë¹„ìš©ì´ ë°œìƒí•˜ì§€ ì•Šë„ë¡ í•©ë‹ˆë‹¤.

<br>

+ ì½”ë£¨í‹´ ì‚¬ìš© ì˜ˆì œ

  ```kotlin
  import kotlinx.coroutines.*
  
  fun main() {
      repeat(3) {
          GlobalScope.launch {
              println("Hi from ${Thread.currentThread()}")
          }
      }
  }c
  ```

  ```kotlin
  Hi from Thread[DefaultDispatcher-worker-2@coroutine#2,5,main]
  Hi from Thread[DefaultDispatcher-worker-1@coroutine#1,5,main]
  Hi from Thread[DefaultDispatcher-worker-1@coroutine#3`,5,main]
  ```

  ìœ„ ìŠ¤ë‹ˆí«ì€ ê¸°ë³¸ Dispatcherë¥¼ ì‚¬ìš©í•˜ì—¬ Global Scopeì—ì„œ ì½”ë£¨í‹´ ì„¸ ê°œë¥¼ ë§Œë“­ë‹ˆë‹¤. `GlobalScope`ëŠ” ì•±ì´ ì‹¤í–‰ë˜ëŠ” í•œ ë‚´ë¶€ì˜ ì½”ë£¨í‹´ì´ ì‹¤í–‰ë˜ë„ë¡ í—ˆìš©í•©ë‹ˆë‹¤. ê¸°ë³¸ ìŠ¤ë ˆë“œì— ê´€í•´ ì–¸ê¸‰í–ˆë˜ ì´ìœ ë¡œ ì¸í•´ ì˜ˆ ì½”ë“œ ì™¸ë¶€ì—ì„œëŠ” ê¶Œì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì•±ì—ì„œ ì½”ë£¨í‹´ì„ ì‚¬ìš©í•  ë•ŒëŠ” ë‹¤ë¥¸ ë²”ìœ„ê°€ ì‚¬ìš©ë©ë‹ˆë‹¤.

  `launch()` í•¨ìˆ˜ëŠ” ì·¨ì†Œ ê°€ëŠ¥í•œ Job ê°ì²´ì— ë˜í•‘ëœ ë‹«íŒ ì½”ë“œì—ì„œ ì½”ë£¨í‹´ì„ ë§Œë“­ë‹ˆë‹¤. `launch()`ëŠ” ë°˜í™˜ ê°’ì´ ì½”ë£¨í‹´ì˜ ë²”ìœ„ ë°–ì—ì„œ í•„ìš”í•˜ì§€ ì•Šì„ ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.

  ì½”ë£¨í‹´ì˜ ì¤‘ìš”í•œ ë‹¤ìŒ ê°œë…ì„ ì´í•´í•˜ê¸° ìœ„í•´ `launch()`ì˜ ì „ì²´ ì„œëª…ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

  ```kotlin
  fun CoroutineScope.launch {
      context: CoroutineContext = EmptyCoroutineContext,
      start: CoroutineStart = CoroutineStart.DEFAULT,
      block: suspend CoroutineScope.() -> Unit
  }
  ```

  ì‹¤ì œë¡œ ê°œë°œìê°€ ì‹¤í–‰ì„ ìœ„í•´ ì „ë‹¬í•œ ì½”ë“œ ë¸”ë¡ì€ `suspend` í‚¤ì›Œë“œë¡œ í‘œì‹œë©ë‹ˆë‹¤. suspend signalsëŠ” ì½”ë“œ ë˜ëŠ” í•¨ìˆ˜ ë¸”ë¡ì´ ì¼ì‹œì¤‘ì§€ë˜ê±°ë‚˜ ì¬ê°œë  ìˆ˜ ìˆìŒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

<br>

#### runBlocking

ë‹¤ìŒ ì˜ˆì—ì„œëŠ” ì´ë¦„ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ ìƒˆ ì½”ë£¨í‹´ì„ ì‹œì‘í•˜ê³  ì™„ë£Œë  ë•Œê¹Œì§€ í˜„ì¬ ìŠ¤ë ˆë“œë¥¼ ì°¨ë‹¨í•˜ëŠ” `runBlocking()`ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì£¼ë¡œ ê¸°ë³¸ í•¨ìˆ˜ì™€ í…ŒìŠ¤íŠ¸ì—ì„œ ì°¨ë‹¨ ì½”ë“œì™€ ë¹„ì°¨ë‹¨ ì½”ë“œ ì‚¬ì´ë¥¼ ì—°ê²°í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. ì¼ë°˜ì ì¸ Android ì½”ë“œì—ì„œëŠ” ìì£¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

```kotlin
import kotlinx.coroutines.*
import java.time.LocalDateTime
import java.time.format.DateTimeFormatter

val formatter = DateTimeFormatter.ISO_LOCAL_TIME
val time = { formatter.format(LocalDateTime.now()) }

suspend fun getValue(): Double {
    println("entering getValue() at ${time()}")
    delay(3000)
    println("leaving getValue() at ${time()}")
    return Math.random()
}

fun main() {
    runBlocking {
        val num1 = getValue()
        val num2 = getValue()
        println("result of num1 + num2 is ${num1 + num2}")
    }
}
```

<br>

`getValue()`ëŠ” ì„¤ì •ëœ ì§€ì—° ì‹œê°„ í›„ì— ëœë¤ ìˆ«ìë¥¼ ë°˜í™˜í•˜ë©° `DateTimeFormatter`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì ì ˆí•œ ì¶œì… ì‹œê°„ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. main í•¨ìˆ˜ëŠ” `getValue()`ë¥¼ ë‘ ë²ˆ í˜¸ì¶œí•˜ê³  í•©ê³„ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```kotlin
entering getValue() at 17:44:52.311
leaving getValue() at 17:44:55.319
entering getValue() at 17:44:55.32
leaving getValue() at 17:44:58.32
result of num1 + num2 is 1.4320332550421415
```

<br>

ì‹¤ì œ ë™ì‘ì„ í™•ì¸í•˜ë ¤ë©´ `main()` í•¨ìˆ˜ë¥¼ ë‹¤ìŒìœ¼ë¡œ ë°”ê¿‰ë‹ˆë‹¤(ë‹¤ë¥¸ ì½”ë“œëŠ” ëª¨ë‘ ìœ ì§€)

```kotlin
fun main() {
    runBlocking {
        val num1 = async { getValue() }
        val num2 = async { getValue() }
        println("result of num1 + num2 is ${num1.await() + num2.await()}")
    }
}
```

ë‘ ë²ˆì˜ `getValue()` í˜¸ì¶œì€ ë…ë¦½ì ì´ë¯€ë¡œ ì •ì§€í•˜ëŠ” ë° ì½”ë£¨í‹´ì´ í•„ìš”í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤

```kotlin
entering getValue() at 22:52:25.025
entering getValue() at 22:52:25.03
leaving getValue() at 22:52:28.03
leaving getValue() at 22:52:28.032
result of num1 + num2 is 0.8416379026501276
```

<br>

`async()` í•¨ìˆ˜ì˜ ì •ì˜

```kotlin
Fun CoroutineScope.async() {
    context: CoroutineContext = EmptyCoroutineContext,
    start: CoroutineStart = CoroutineStart.DEFAULT,
    block: suspend CoroutineScope.() -> T
}: Deferred<T>
```

`async()` í•¨ìˆ˜ëŠ” `Deferred` ìœ í˜•ì˜ ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤. 
`Deferred`ëŠ” **ë¯¸ë˜ ê°’ ì°¸ì¡°ë¥¼ ë³´ìœ í•  ìˆ˜ ìˆëŠ” ì·¨ì†Œ ê°€ëŠ¥í•œ `Job`**ì…ë‹ˆë‹¤. `Deferred`ë¥¼ ì‚¬ìš©í•˜ë©´ ì¦‰ì‹œ ê°’ì„ ë°˜í™˜í•˜ëŠ” ê²ƒì²˜ëŸ¼ í•¨ìˆ˜ë¥¼ ê³„ì† í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¹„ë™ê¸°(asynchronous) ì‘ì—…ì´ ì–¸ì œ ë°˜í™˜ë ì§€ í™•ì‹¤íˆ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— `Deferred`ëŠ” ìë¦¬í‘œì‹œì ì—­í• ë§Œ í•©ë‹ˆë‹¤. 
`Deferred`(ë‹¤ë¥¸ ì–¸ì–´ì—ì„œëŠ” Promiseë‚˜ Futureë¼ê³ ë„ í•¨)ëŠ” **ë‚˜ì¤‘ì— ì´ ê°ì²´ì— ê°’ì´ ë°˜í™˜ëœë‹¤ê³  ë³´ì¥**í•©ë‹ˆë‹¤. ë°˜ë©´ ë¹„ë™ê¸° ì‘ì—…ì€ ê¸°ë³¸ì ìœ¼ë¡œ ì‹¤í–‰ì„ ì°¨ë‹¨í•˜ê±°ë‚˜ ê¸°ë‹¤ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤. **í˜„ì¬ ì½”ë“œ ì¤„ì´ `Deferred`ì˜ ì¶œë ¥ì„ ê¸°ë‹¤ë¦¬ë„ë¡ í•˜ë ¤ë©´ ì½”ë“œ ì¤„ì—ì„œ `await()`ë¥¼ í˜¸ì¶œí•˜ë©´ ë©ë‹ˆë‹¤.** ê·¸ëŸ¬ë©´ ì›ì‹œ ê°’(raw value)ì´ ë°˜í™˜ë©ë‹ˆë‹¤.

<br>

#### í•¨ìˆ˜ë¥¼ suspendë¡œ í‘œì‹œí•˜ëŠ” ê²½ìš°

+ ì•ì˜ ì˜ˆì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ `getValue()` í•¨ìˆ˜ë„ `suspend` í‚¤ì›Œë“œë¡œ ì •ì˜ë©ë‹ˆë‹¤. `suspend` í•¨ìˆ˜ì´ê¸°ë„ í•œ `delay()`ë¥¼ í˜¸ì¶œí•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. í•¨ìˆ˜ê°€ ë˜ ë‹¤ë¥¸ `suspend` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ì–¸ì œë“ ì§€ ê·¸ í•¨ìˆ˜ëŠ” `suspend` í•¨ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤.
+ ê·¸ë ‡ë‹¤ë©´ ì´ ì˜ˆì—ì„œ `main()` í•¨ìˆ˜ê°€ `suspend`ë¡œ í‘œì‹œë˜ì§€ ì•Šì€ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”? ê²°êµ­ `getValue()`ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
+ ê¼­ ê·¸ë ‡ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. `getValue()`ëŠ” `launch()`ì™€ `async()`ì— ì „ë‹¬ëœ í•¨ìˆ˜ì™€ ë¹„ìŠ·í•œ `runBlocking()`ì— ì „ë‹¬ëœ í•¨ìˆ˜ì¸ `suspend` í•¨ìˆ˜ì—ì„œ í˜¸ì¶œë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ `getValue()`ê°€ `main()` ìì²´ì—ì„œ í˜¸ì¶œë˜ì§€ë„ ì•Šê³  `runBlocking()`ì´ `suspend` í•¨ìˆ˜ë„ ì•„ë‹ˆë¯€ë¡œ `main()`ì€ `suspend`ë¡œ í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•¨ìˆ˜ê°€ `suspend` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë©´ ê·¸ ìì²´ê°€ `suspend` í•¨ìˆ˜ê°€ ì•„ë‹ˆì–´ë„ ë©ë‹ˆë‹¤.

<br>

<br>

### ì½”ë£¨í‹´ ì‚¬ìš©

ì²˜ìŒ ì½”ë“œ

```kotlin
fun main() {
   val states = arrayOf("Starting", "Doing Task 1", "Doing Task 2", "Ending")
   repeat(3) {
       Thread {
           println("${Thread.currentThread()} has started")
           for (i in states) {
               println("${Thread.currentThread()} - $i")
               Thread.sleep(50)
           }
       }.start()
   }
}
```

<br>

ì½”ë£¨í‹´ ì‚¬ìš©

```kotlin
import kotlinx.coroutines.*

fun main() {
   val states = arrayOf("Starting", "Doing Task 1", "Doing Task 2", "Ending")
   repeat(3) {
       GlobalScope.launch {
           println("${Thread.currentThread()} has started")
           for (i in states) {
               println("${Thread.currentThread()} - $i")
               delay(5000)
           }
       }
   }
}
```

<br>

<br>

## ğŸ– Quiz/Unit4/Pathway4 

1. ë¹ˆì¹¸ ì±„ìš°ê¸°

   **ê¸°ë³¸** ìŠ¤ë ˆë“œ(UI ìŠ¤ë ˆë“œë¼ê³ ë„ í•¨)ëŠ” Android ì•±ì—ì„œ í™”ë©´ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.

<br>

2. ë‹¤ìŒ ì¤‘ ì½”ë“œì—ì„œ ìŠ¤ë ˆë“œë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ì´ˆë˜ë  ìˆ˜ ìˆëŠ” ìœ„í—˜ì€ ë¬´ì—‡ì¸ê°€ìš”?

   =>

   + ê²½í•© ìƒíƒœ ë°œìƒ
   + ì¶œë ¥ì´ ì¼ê´€ë˜ì§€ ì•ŠìŒ
   + UIê°€ ì‘ë‹µí•˜ì§€ ì•ŠìŒ

<br>

3. ì½”ë£¨í‹´ì— ê´€í•œ ë‹¤ìŒ ì„¤ëª… ì¤‘ ì°¸ì¸ ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”?

   => ì½”ë£¨í‹´ì€ ì‹¤í–‰ë˜ê±°ë‚˜ ì‹¤í–‰ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

4. ì°¸ ë˜ëŠ” ê±°ì§“: í•¨ìˆ˜ê°€ ì´ë¯¸ `suspend` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ ê²½ìš° ìì²´ì ìœ¼ë¡œ ì •ì§€ í•¨ìˆ˜ë¡œ í‘œì‹œí•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.

   => ê±°ì§“

<br>

5. ë‹¤ìŒ ì¤‘ `suspend` í•¨ìˆ˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”?

   => 

   + `async()`ì— ì „ë‹¬ëœ ëŒë‹¤
   + `runBlocking()`ì— ì „ë‹¬ëœ ëŒë‹¤

<br>

6. `async()` ë° `runBlocking()`ì— ê´€í•œ ë‹¤ìŒ ì„¤ëª… ì¤‘ ê±°ì§“ì¸ ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”?

    => ë‘ í•¨ìˆ˜ ëª¨ë‘ Deferredë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

<br>

7. ì°¸ ë˜ëŠ” ê±°ì§“: ëŒ€ë¶€ë¶„ì˜ ì•±ì—ì„œëŠ” ì „ì—­ ë²”ìœ„ë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë£¨í‹´ì„ ë§Œë“­ë‹ˆë‹¤.

   => ê±°ì§“

<br>

8. ì½”ë£¨í‹´ì´ ì´ë©´ì—ì„œ ì‚¬ìš©í•˜ëŠ” ìŠ¤ë ˆë“œë¥¼ ê²°ì •í•˜ëŠ” ì—­í• ì„ í•˜ëŠ” ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”?

   => `Dispatcher`

<br>

9. ë¹ˆì¹¸ ì±„ìš°ê¸°

   **Deferred**ì€(ëŠ”) ë‹¤ë¥¸ ì–¸ì–´ì˜ Promise ë˜ëŠ” Futureì™€ ìœ ì‚¬í•˜ë©° ë°˜í™˜ ê°’ì˜ ìë¦¬í‘œì‹œì ì—­í• ì„ í•©ë‹ˆë‹¤.

<br>

10. ì°¸ ë˜ëŠ” ê±°ì§“: `Job`ì€ ì½”ë£¨í‹´ì´ ì‹¤í–‰í•˜ëŠ” ì·¨ì†Œ ê°€ëŠ¥í•œ ì‘ì—… ë‹¨ìœ„ì…ë‹ˆë‹¤.

    => ì°¸